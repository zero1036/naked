angular.module("ui.nd",["nd.wall"]),angular.module("nd.wall",["ngAnimate"]).constant("wallConfig",{openClass:"open"}).service("wallService",["$document","$rootScope",function(n,e){var t=null;this.open=function(e,l){t||n.bind("touchstart",o),t&&t!==e&&l&&1==l&&(t.isOpen=!1),t=e},this.close=function(e){t===e&&(t=null,n.unbind("click",o))};var o=function(n){if(t&&(!n||"disabled"!==t.getAutoClose())){var o=t.getToggleElement();if(!(n&&o&&o[0].contains(n.target))){var l=t.getDropdownElement();n&&"outsideClick"===t.getAutoClose()&&l&&l[0].contains(n.target)||(t.isOpen=!1,e.$$phase||t.$apply())}}}}]).controller("ndWallCtrl",["$scope","$attrs","$parse","wallConfig","wallService","$animate","$document","$compile","$templateRequest",function(n,e,t,o,l,i,a,s,u){var r,c=this,g=n.$new(),d=o.openClass,p=angular.noop,f=e.onToggle?t(e.onToggle):angular.noop,$=(a.find("body"),angular.isDefined(e.isOnly)?e.isOnly:!0);this.init=function(o){c.$element=o,e.isOpen&&(r=t(e.isOpen),p=r.assign,n.$watch(r,function(n){g.isOpen=!!n}))},this.toggle=function(n){return g.isOpen=arguments.length?!!n:!g.isOpen},this.isOpen=function(){return g.isOpen},g.getToggleElement=function(){return c.toggleElement},g.getAutoClose=function(){return e.autoClose||"always"},g.getElement=function(){return c.$element},g.getDropdownElement=function(){return c.dropdownMenu},g.focusToggleElement=function(){c.toggleElement&&c.toggleElement[0].focus()},g.$watch("isOpen",function(e,t){var o=c.$element;i[e?"addClass":"removeClass"](o,d).then(function(){angular.isDefined(e)&&e!==t&&f(n,{open:!!e})}),e?(g.focusToggleElement(),l.open(g,$)):l.close(g),angular.isFunction(p)&&p(n,e)}),n.$on("$locationChangeSuccess",function(){"disabled"!==g.getAutoClose()&&(g.isOpen=!1)});var m=n.$on("$destroy",function(){g.$destroy()});g.$on("$destroy",m)}]).directive("ndWall",function(){return{controller:"ndWallCtrl",link:function(n,e,t,o){o.init(e),e.addClass("nd-wall")}}}).directive("ndWallTogglePub",["$parse",function(n){return{link:function(e,t,o,l){if(angular.isDefined(o.isOpen)){var i,a=angular.noop;i=n(o.isOpen),a=i.assign;var s=function(n){n.preventDefault(),n.stopPropagation();var t=i(e);e.$apply(function(){a(e,!t)})};t.bind("click",s)}}}}]).directive("ndWallToggle",function(){return{require:"?^ndWall",link:function(n,e,t,o){if(o){e.addClass("nd-wall-toggle"),o.toggleElement=e;var l=function(l){l.preventDefault(),e.hasClass("disabled")||t.disabled||n.$apply(function(){o.toggle()})};e.bind("click",l),e.attr({"aria-haspopup":!0,"aria-expanded":!1}),n.$watch(o.isOpen,function(n){e.attr("aria-expanded",!!n)}),n.$on("$destroy",function(){e.unbind("click",l)})}}}});